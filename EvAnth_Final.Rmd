---
title: "EvAnth_Final"
author: "Carly Levi"
date: "November 22, 2015"
output: html_document
---
```{r}
set.seed(83942)
library(ggplot2)
library(dplyr)
library(stringr)
```

```{r}
numloci<-10 
eff<-rnorm(numloci,0,1)
numind<-10000#number of individuals to sample
high<-2*sum(replace(eff,eff<0,0)) 
low<-2*sum(replace(eff,eff>0,0))
pheno<-c() 
genomat <- matrix(NA, nrow = numind, ncol = numloci) 
#sample_dist <- data.frame(means = rep(NA, 15000))
pheno_df <- data.frame(phenos = rep(NA, numind))
for(i in 1:numind){
   geno<-replicate(numloci,sum(sample(c(0,1),2,replace=T)))
   genomat[i,]<-geno
   pheno_df$phenos[i] <- geno %*% eff
}
hist(pheno_df$phenos,breaks = 100, main = '',xlab='phenotypic value',xlim=c(low-0.5,high+0.5))
pheno_df
geno
sd <- sd(pheno_df$phenos)
sd
mean <- mean(pheno_df$phenos)
mean

feeble <- pheno_df %>%
  filter(phenos < (mean - 2*sd))
feeble

high_function <- pheno_df %>%
  filter(phenos > (mean + 2*sd))
high_function

normal <- pheno_df %>%
  filter(phenos < (mean + 2*sd), phenos > (mean - 2*sd)) 
normal

```
geno = 10 loci (0,1,2)

pheno = value plotted on histogram

sample size = 10000

put pheno in data frame

filter(pheno > 2sd,pheno < 2sd )

feeble <- pheno_df %>%
  filter(pheno < (mean - 2*sd))
