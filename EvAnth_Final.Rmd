---
title: "EvAnth_Final"
author: "Carly Levi"
date: "November 22, 2015"
output: html_document
---
```{r}
set.seed(83942)
library(ggplot2)
library(dplyr)
library(stringr)
```
 
```{r}
numloci<-10 #number of loci, feeblemindedness is a complex trait
eff<-rnorm(numloci,0,1) #effect size
numind<-1000 #number of individuals to sample
high<-2*sum(replace(eff,eff<0,0))
low<-2*sum(replace(eff,eff>0,0))
genomat <- matrix(NA, nrow = numind, ncol = numloci + 1)
pheno_df <- data.frame(phenos = rep(NA, numind))
for(i in 1:numind){
   geno<-replicate(numloci,sum(sample(c(0,1),2,replace=T)))
   genomat[i, 1:10]<-geno
   genomat[i,11] <- geno %*% eff
   pheno_df$phenos[i] <- geno %*% eff
}
 
hist(pheno_df$phenos,breaks = 100, main = '',xlab='phenotypic value',xlim=c(low-0.5,high+0.5))
abline(v=(-3.651707), col='red')
abline(v=(6.781549), col='red')
 
sd <- sd(pheno_df$phenos)
sd
 
mean <- mean(pheno_df$phenos)
mean
 
genomat2 <- as.data.frame(genomat)
 
feeble <- genomat2 %>% #gives number of feeble minded individuals and phenotype
  filter(genomat2[,11] < (mean - 2*sd))
 
high_function <- genomat2 %>% #gives number of high functioning individuals and phenotype
  filter(genomat2[,11] > (mean + 2*sd))
 
normal <- pheno_df %>% #gives number of normal individuals and phenotype
  filter(genomat2[,11] < (mean + 2*sd), genomat2[,11] > (mean - 2*sd))
```
 
```{r}
geno1 <- feeble[sample(nrow(feeble), numind,replace = TRUE),]
geno1<- as.data.frame(geno1)
 
geno2 <- feeble[sample(nrow(feeble), numind,replace = TRUE), ]
geno2 <- as.data.frame(geno2)
```
 
```{r}
pheno_feeble_feeble <- data.frame(phenos = rep(NA, numind))
genokid <- matrix(rep(NA, numind * 10), nrow = 1000, ncol = 10)
```
 
```{r}
genokid <- geno1 + geno2
 
genokid
pheno_feeble_feeble <- genokid[,11]
pheno_feeble_feeble
```
 
```{r eval = FALSE}
f1num<-numind
f1genomat<-matrix(NA,nrow=f1num,ncol=numloci)
f1pheno<-c()
sampmat<-matrix(pheno_feeble_feeble$phenos,nrow=numind,ncol=2,byrow=T)
sampmat
```
 
```
 
 
for(i in 1:f1num){
allele1<-sapply(geno1,function(x) sample(sampmat[x+1,],1)) #sample from low phenotype pare nt
allele2<-sapply(geno2,function(x) sample(sampmat[x+1,],1)) #sample from high phenotype p arent
    f1genomat[i,]<-allele1+allele2
    f1pheno<-c(f1pheno,(allele1+allele2)%*%eff)
}
 
hist(pheno_df$phenos,breaks=20,main='',xlab='phenotypic value',xlim=c(low-0.5,high+0.5),col=rgb(1,0,0,1/4),freq=F,ylim=c(0,1))
 
hist(f1pheno,breaks=20,main='',xlab='phenotypic value',xlim=c(low-0.5,high+0.5),col=rgb(0,0,1,1/4),add=T,freq=F)